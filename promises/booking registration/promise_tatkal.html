<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <h1>Tatkal Booking System</h1>
    <div>
        <div id="train1"></div>
        <div id="train2"></div>
        <div id="train3"></div>

    </div>
  <button onclick="CheckAvailability()">Check Availability</button>

</body>
</html>
<script>
    let BtoG=["Dhoni","Kohli","Alan","Groot","jhetalal","Mr Bean","Bhvan Bam","Shaktiman"];

    let MtoG=["Dhoni","Kohli","Alan","Groot","jhetalal","Mr Bean","Bhvan Bam","Shaktiman"];

    let PtoG=["Dhoni","Kohli","Alan","Groot","jhetalal","Mr Bean","Bhvan Bam","Shaktiman"];

    async function CheckAvailability() {

        let promise=new Promise( function (resolve,reject)  {
         setInterval(function () {
             let train_1=document.getElementById("train1");
             let train_2=document.getElementById("train2");
             let train_3=document.getElementById("train3");
             train_1.textContent="BtoG seat"+" "+BtoG.length;
             train_2.textContent="MtoG seat"+" "+MtoG.length;
             train_3.textContent="PtoG seat"+" "+PtoG.length;

            if(BtoG.length<=4) {
                resolve(`BtoG is available`);
                window.location.href="tatkal_book.html";
            }
                else if(MtoG.length<=4) {
                resolve(`MtoG is available`);
                window.location.href="tatkal_book.html";
            }
            else if(PtoG.length<=4) {
                resolve(`PtoG is available`);
                window.location.href="tatkal_book.html";
            }
        },1000)
        });

        let res =  await promise;
        localStorage.setItem("train",JSON.stringify(res));
        console.log("res:",res);

    }

    function cancelTicket(){
         //cancelition speed should be random


         let cancelling_speed1=Math.round(Math.random()*5)

         let cancelling_speed2=Math.round(Math.random()*5)

         let cancelling_speed3=Math.round(Math.random()*5)
setTimeout(function () {
    BtoG.pop();
},cancelling_speed1*1000);

setTimeout(function () {
    MtoG.pop();
},cancelling_speed2*1000);

setTimeout(function () {
   PtoG.pop();
},cancelling_speed3*1000);

console.log(BtoG,MtoG,PtoG);
    }

    let interval=setInterval(cancelTicket,2000);
</script>
